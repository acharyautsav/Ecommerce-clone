<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Cart - ShopMart</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f5f5f5; }
        .header { background: linear-gradient(135deg, #ff6b35, #f7931e); color: white; padding: 10px 0; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header-container { max-width: 1200px; margin: 0 auto; padding: 0 20px; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 28px; font-weight: bold; text-decoration: none; color: white; }
        .nav-links { display: flex; gap: 20px; align-items: center; }
        .user-info { display: flex; align-items: center; gap: 10px; }
        .user-avatar { width: 35px; height: 35px; border-radius: 50%; background: #007bff; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; }
        .logout-btn { background: linear-gradient(135deg, #ff6b35, #f7931e); border: none; color: white; border-radius: 5px; padding: 6px 12px; cursor: pointer; font-size: 14px; font-weight: 600; }
        .cart-btn { font-size: 22px; cursor: pointer; margin: 0 10px; background: none; border: none; color: white; }
        .main-container { max-width: 900px; margin: 30px auto; padding: 20px; background: white; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); }
        h1 { font-size: 28px; margin-bottom: 20px; color: #333; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        th, td { padding: 12px 10px; text-align: left; }
        th { background: #f7931e; color: white; }
        tr:nth-child(even) { background: #f9f9f9; }
        tr:nth-child(odd) { background: #fff; }
        .remove-btn { background: #dc3545; color: white; border: none; border-radius: 5px; padding: 6px 12px; cursor: pointer; font-size: 14px; }
        .total-row td { font-weight: bold; font-size: 18px; }
        .empty-cart { text-align: center; color: #888; font-size: 20px; margin: 40px 0; }
        @media (max-width: 600px) { .main-container { padding: 8px; } table, th, td { font-size: 13px; } }
    </style>
</head>
<body>
<header class="header">
    <div class="header-container">
        <a href="/customer/dashboard" class="logo">ShopMart</a>
        <div class="nav-links">
            <div class="user-info">
                <div class="user-avatar" th:text="${customerName.substring(0,1)}">U</div>
                <span th:text="${customerName}">Customer</span>
                <form th:action="@{/logout}" method="get" style="display:inline;">
                    <button class="logout-btn" type="submit">Logout</button>
                </form>
            </div>
        </div>
    </div>
</header>
<main class="main-container">
    <h1>Your Cart</h1>
    <div th:if="${#lists.isEmpty(cartItems)}" class="empty-cart">Your cart is empty.</div>
    <table th:if="${!#lists.isEmpty(cartItems)}">
        <thead>
            <tr>
                <th>Product</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Total</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="item : ${cartItems}">
                <td th:text="${item.product.productName}">Product Name</td>
                <td th:text="'$' + ${item.itemsOrderedPrice}">$0.00</td>
                <td>
                    <button type="button" style="background:#eee; border:none; border-radius:4px; width:28px; height:28px; font-size:18px; cursor:pointer; margin-right:4px;" th:onclick="|changeQuantity(${item.itemsOrderedId}, 'decrease')|">-</button>
                    <span th:text="${item.itemsOrderedQuantity}">1</span>
                    <button type="button" style="background:#eee; border:none; border-radius:4px; width:28px; height:28px; font-size:18px; cursor:pointer; margin-left:4px;" th:onclick="|changeQuantity(${item.itemsOrderedId}, 'increase')|">+</button>
                </td>
                <td th:text="'$' + (${item.itemsOrderedPrice} * ${item.itemsOrderedQuantity})">$0.00</td>
                <td><button class="remove-btn" type="button" th:onclick="|removeFromCart(${item.itemsOrderedId})|">Remove</button></td>
            </tr>
        </tbody>
        <tfoot>
            <tr class="total-row">
                <td colspan="3">Total</td>
                <td th:text="'$' + ${cartTotal}">$0.00</td>
                <td></td>
            </tr>
        </tfoot>
    </table>
    <script>
function removeFromCart(itemId) {
    fetch('/cart/remove/' + itemId, {
        method: 'DELETE'
    }).then(response => {
        if (response.ok) {
            window.location.reload();
        } else {
            alert('Failed to remove item from cart.');
        }
    }).catch(() => alert('Failed to remove item from cart.'));
}

function changeQuantity(itemId, action) {
    fetch(`/cart/${action}/` + itemId, {
        method: 'POST'
    }).then(response => {
        if (response.ok) {
            window.location.reload();
        } else {
            alert('Failed to update quantity.');
        }
    }).catch(() => alert('Failed to update quantity.'));
}
</script>
    <div th:if="${!#lists.isEmpty(cartItems)}" style="margin-top: 24px; text-align: right; margin-right: 1.5cm;">
        <button style="background: linear-gradient(135deg, #ff6b35, #f7931e); color: white; border: none; border-radius: 8px; padding: 12px 32px; font-size: 18px; font-weight: bold; cursor: pointer;">Checkout</button>
    </div>
</main>
</body>
</html> 